package zk

import (
	"fmt"
	"math/big"

	"github.com/taurusgroup/cmp-ecdsa/pkg/paillier"
	"github.com/taurusgroup/cmp-ecdsa/pkg/pedersen"
)

var (
	ProverPaillierPublic   *paillier.PublicKey
	ProverPaillierSecret   *paillier.SecretKey
	VerifierPaillierPublic *paillier.PublicKey
	VerifierPaillierSecret *paillier.SecretKey
	Pedersen               *pedersen.Parameters
)

func generate() {
	sk1 := paillier.NewSecretKey()
	sk2 := paillier.NewSecretKey()
	fmt.Println("var p1, q1, p2, q2, s, t big.Int")
	fmt.Printf("p1.SetString(\"%s\", 10)\n", sk1.P)
	fmt.Printf("q1.SetString(\"%s\", 10)\n", sk1.Q)
	fmt.Printf("p2.SetString(\"%s\", 10)\n", sk2.P)
	fmt.Printf("q2.SetString(\"%s\", 10)\n", sk2.Q)

	fmt.Println("ProverPaillierSecret = paillier.NewSecretKeyFromPrimes(&p1, &q1)")
	fmt.Println("VerifierPaillierSecret = paillier.NewSecretKeyFromPrimes(&p2, &q2)")
	fmt.Println("ProverPaillierPublic = ProverPaillierSecret.publicKey()")
	fmt.Println("VerifierPaillierPublic = VerifierPaillierSecret.publicKey()")
	ped, _ := sk2.GeneratePedersen()
	fmt.Printf("s.SetString(\"%s\", 10)\n", ped.S)
	fmt.Printf("t.SetString(\"%s\", 10)\n", ped.T)
	fmt.Println("Pedersen = &pedersen.Parameters{N: VerifierPaillierPublic.N, S: &s, T: &t}")
}

func init() {
	var p1, q1, p2, q2, s, t big.Int
	p1.SetString("143267995799105796417509558433549675226448537439386925464270530106728045991407119735750792477387188739877982497671222147203486414681024670364317025928362915120590607612553947826405186557644576642024977663118465445424194618219769011699507251264426174416435810953395621445026247154608403414657928658859664316879", 10)
	q1.SetString("179422062119310160206756114790157635939829510776664432448408810841578163827190664562067925626469409613518932095469516426763613554114782870980739866140214024406484601252947673033725711660579024456616522953158808812613913522754624070584898646683077721593772816949621000374091863046985077426332600084862021561559", 10)
	p2.SetString("152154404858116107352451376710508953435780581388146967399069423470560258124954422750333254228910765676435362598962373233531181927100506747450822302342798709349277994605999555370463296176334366408247274535314056304522594488992309900484501407239806084820522670212107392814258629401616527959039287619018544629087", 10)
	q2.SetString("150367962560634520520178660005114472045952171422871757019766534358275446888505293395397120505633865723992882252999380749819948592730204386006289539072610297536731829196262186322196549150482324005808599453233358430155647935818430337772543565350989774492578955968578048509691124891256619914186346952959848181303", 10)
	ProverPaillierSecret = paillier.NewSecretKeyFromPrimes(&p1, &q1)
	VerifierPaillierSecret = paillier.NewSecretKeyFromPrimes(&p2, &q2)
	ProverPaillierPublic = ProverPaillierSecret.PublicKey
	VerifierPaillierPublic = VerifierPaillierSecret.PublicKey
	s.SetString("4438843595469733481366198053466737379871431451387073453705885237399373857543852075886246760874380207387499634446686492713271960194925650239820457066705365901935465424150066421361642784828766780758042098973609798346943158805238394944635183654574331645060642154648153275307943863061259716895833984441173001987729330622361673624154022227179270530312147752536658439443415981689783772104900301011744199687071834807211811875884275233499417756583456566003961982665368746213695949979361153436705596276414249201031290084689933912499293905844894973995641494060037768784013960298456003048844222054427545283087839007610945456388", 10)
	t.SetString("17700551941653487529670012409113092533083383566456817423668445254903092528208099729918168751604816962943010195231998632058028981687807860198893153589615048535955711601230892714026913382002218857831227236840291985101869108739511056065753575698080485763245206308532847120351662859225435070701357538144313481872034762165386793438255300146355259734811466568432096633267754516200681009148567540467336618216884601088831126026892101150716276380735787493084117310146898791055582722110120195047952028871952956791760835443148190472239416546658386431515901318697707050668118210366457363727725398064459201818545327674795062484230", 10)
	Pedersen = &pedersen.Parameters{N: VerifierPaillierPublic.N, S: &s, T: &t}
}
